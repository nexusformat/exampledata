 
import numpy as np
from nexusformat.nexus import *
 
# Note this example script was generated by nxdl_to_hdf5.py using the current 
# installed version of the NEXUS definitions ver[v2020.10] 
 
root = NXroot()

# Create the GROUPS 
root['/entry'] = NXentry()
root['/entry'].attrs['EX_required'] = 'true'
root['/entry/instrument'] = NXinstrument()
root['/entry/instrument'].attrs['EX_required'] = 'true'
root['/entry/instrument/source'] = NXsource()
root['/entry/instrument/source'].attrs['EX_required'] = 'true'
root['/entry/instrument/monochromator'] = NXmonochromator()
root['/entry/instrument/monochromator'].attrs['EX_required'] = 'true'
root['/entry/instrument/detector'] = NXdetector()
root['/entry/instrument/detector'].attrs['EX_required'] = 'true'
root['/entry/sample'] = NXsample()
root['/entry/sample'].attrs['EX_required'] = 'true'
root['/entry/data'] = NXdata()
root['/entry/data'].attrs['EX_required'] = 'true'

# Create the FIELDS 
 
root['/entry/title'] = NXfield('SAMPLE-CHAR-DATA')
root['/entry/title'].attrs['type'] = 'NX_CHAR'
root['/entry/title'].attrs['EX_required'] = 'true'
 
root['/entry/start_time'] = NXfield('2022-03-03T14:34:14.801656')
root['/entry/start_time'].attrs['type'] = 'NX_DATE_TIME'
root['/entry/start_time'].attrs['EX_required'] = 'true'
 
root['/entry/end_time'] = NXfield('2022-03-03T14:34:14.801656')
root['/entry/end_time'].attrs['type'] = 'NX_DATE_TIME'
root['/entry/end_time'].attrs['EX_required'] = 'true'
 
# Valid enumeration values for root['/entry']['definition'] are: 
#	 NXpeem
 
root['/entry/definition'] = NXfield('NXpeem')
root['/entry/definition'].attrs['type'] = 'NX_CHAR'
root['/entry/definition'].attrs['EX_required'] = 'true'
 
root['/entry/instrument/source/type'] = NXfield('SAMPLE-CHAR-DATA')
root['/entry/instrument/source/type'].attrs['type'] = 'NX_CHAR'
root['/entry/instrument/source/type'].attrs['EX_required'] = 'true'
 
root['/entry/instrument/source/name'] = NXfield('SAMPLE-CHAR-DATA')
root['/entry/instrument/source/name'].attrs['type'] = 'NX_CHAR'
root['/entry/instrument/source/name'].attrs['EX_required'] = 'true'
 
root['/entry/instrument/source/probe'] = NXfield('SAMPLE-CHAR-DATA')
root['/entry/instrument/source/probe'].attrs['type'] = 'NX_CHAR'
root['/entry/instrument/source/probe'].attrs['EX_required'] = 'true'
 
root['/entry/instrument/monochromator/energy'] = NXfield(1.0)
root['/entry/instrument/monochromator/energy'].attrs['type'] = 'NX_FLOAT'
root['/entry/instrument/monochromator/energy'].attrs['EX_required'] = 'true'
 
root['/entry/instrument/detector/data'] = NXfield(1.0)
root['/entry/instrument/detector/data'].attrs['type'] = 'NX_NUMBER'
root['/entry/instrument/detector/data'].attrs['EX_required'] = 'true'
 
root['/entry/sample/rotation_angle'] = NXfield(1.0)
root['/entry/sample/rotation_angle'].attrs['type'] = 'NX_FLOAT'
root['/entry/sample/rotation_angle'].attrs['EX_required'] = 'true'
 
# Valid enumeration values for root['/entry/data']['peem_scan_type'] are: 
#	 single image scan
#	 stack scan
#	 focus scan
#	 single variable scan
#	 two variable scan
#	 time scan
 
root['/entry/data/peem_scan_type'] = NXfield('single image scan')
root['/entry/data/peem_scan_type'].attrs['type'] = 'NX_CHAR'
root['/entry/data/peem_scan_type'].attrs['EX_required'] = 'true'
 
root['/entry/data/img_data'] = NXfield(1.0)
root['/entry/data/img_data'].attrs['type'] = 'NX_NUMBER'
root['/entry/data/img_data'].attrs['EX_required'] = 'true'
 
root['/entry/data/spec_data'] = NXfield(1.0)
root['/entry/data/spec_data'].attrs['type'] = 'NX_NUMBER'
root['/entry/data/spec_data'].attrs['EX_required'] = 'true'
root['/entry/data/spec_data'].attrs['signal'] = '1'
 
root['/entry/data/energy'] = NXfield(1.0)
root['/entry/data/energy'].attrs['type'] = 'NX_FLOAT'
root['/entry/data/energy'].attrs['EX_required'] = 'true'
 
root['/entry/data/polarization'] = NXfield(1.0)
root['/entry/data/polarization'].attrs['type'] = 'NX_FLOAT'
root['/entry/data/polarization'].attrs['EX_required'] = 'false'
 
root['/entry/data/averages'] = NXfield(1)
root['/entry/data/averages'].attrs['type'] = 'NX_INTEGER'
root['/entry/data/averages'].attrs['EX_required'] = 'true'
 
root['/entry/data/count_time'] = NXfield(1.0)
root['/entry/data/count_time'].attrs['type'] = 'NX_FLOAT'
root['/entry/data/count_time'].attrs['EX_required'] = 'true'

# Create the DOC strings 
root['/entry/definition'].attrs['EX_doc'] = 'Official NeXus NXDL schema to which this file conforms '
root['/entry/instrument/detector/data'].attrs['EX_doc'] = 'Detector data should be presented with the first dimension corresponding to the scan point and subsequent dimensions corresponding to the output of the detector. Detectors that provide more than one value per scan point should have a data array of rank 1+d, where d is the dimensions of the array provided per scan point. For example, an area detector should have an NXdetector data array of 3 dimensions, with the first being the set of scan points and the latter two being the x- and y- extent of the detector '
root['/entry/data'].attrs['EX_doc'] = 'This will contain all the data for a particular ROI '
root['/entry/data/peem_scan_type'].attrs['EX_doc'] = 'Label for typical scan types as a convenience for humans. Each label corresponds to a specific set of axes being scanned to produce a data array of shape: * single image scan: (photon_energy, 2D image data) * stack scan: (photon_energy, polarization, 2D image data + 1D spectra) * focus scan: (photon_energy, 2D image data) * single variable scan: (variable, 2D image data + 1D spectra) * two variable scan: (variable1, variable2, 2D image data + 1D spectra) * time scan: (time, 2D image data + 1D spectra) The "single image scan" string is to be used when none of the other choices are appropriate. '
root['/entry/data/img_data'].attrs['EX_doc'] = 'This will contain a multi dimensonal array that with the columns determined by the scan type '
root['/entry/data/spec_data'].attrs['EX_doc'] = 'This will contain a multi dimensonal array that with the columns determined by the scan type '
root['/entry/data/energy'].attrs['EX_doc'] = 'List of photon energies of the X-ray beam. If scanned through multiple values, then an "axis" attribute will be required to link the field to the appropriate data array dimension. '
root['/entry/data/polarization'].attrs['EX_doc'] = 'List of polarizations. If scanned through multiple values, then an "axis" attribute will be required to link the field to the appropriate data array dimension. '
root['/entry/data/averages'].attrs['EX_doc'] = 'List of Y positions on the sample. If scanned through multiple values, then an "axis" attribute will be required to link the field to the appropriate data array dimension. '
root['/entry/data/count_time'].attrs['EX_doc'] = 'List of dwell times for each point in the scan, they may vary point to point, then an "axis" attribute will be required to link the field to the appropriate data array dimension. '
 

# Create the ATTRIBUTES 
root.attrs['default'] = 'entry'
root['/entry/data'].set_default()
root['/entry/data'].attrs['signal'] = 'averages'
root['/entry/data/averages'].attrs['signal'] = '1'

# Save the file
root.save('NXpeem.nxs', 'w')


